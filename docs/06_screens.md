# HOBBS - 画面設計

## 1. 画面遷移図

```
                              ┌─────────────┐
                              │   接続     │
                              └──────┬──────┘
                                     │
                              ┌──────▼──────┐
                              │ ウェルカム  │
                              └──────┬──────┘
                                     │
                    ┌────────────────┼────────────────┐
                    │                │                │
             ┌──────▼──────┐  ┌──────▼──────┐  ┌──────▼──────┐
             │  ログイン   │  │  新規登録  │  │  ゲスト    │
             └──────┬──────┘  └──────┬──────┘  └──────┬──────┘
                    │                │                │
                    └────────────────┼────────────────┘
                                     │
                              ┌──────▼──────┐
                              │ メインメニュー│
                              └──────┬──────┘
                                     │
          ┌──────────┬───────────────┼───────────────┬──────────┐
          │          │               │               │          │
   ┌──────▼──────┐ ┌─▼──────┐ ┌──────▼──────┐ ┌──────▼─┐ ┌──────▼──────┐
   │  掲示板    │ │ チャット│ │   メール   │ │ファイル│ │ プロフィール│
   └──────┬──────┘ └────────┘ └──────┬──────┘ └────────┘ └─────────────┘
          │                          │
   ┌──────▼──────┐            ┌──────▼──────┐
   │ スレッド/  │            │  メール    │
   │ 記事一覧   │            │  詳細      │
   └──────┬──────┘            └─────────────┘
          │
   ┌──────▼──────┐
   │  記事詳細  │
   └─────────────┘
```

## 2. 画面レイアウト - 標準端末（80x24、ANSI対応）

### 2.1 ウェルカム画面

```
================================================================================
     _   _  ___  ____  ____  ____
    | | | |/ _ \| __ )| __ )/ ___|
    | |_| | | | |  _ \|  _ \\___ \
    |  _  | |_| | |_) | |_) |___) |
    |_| |_|\___/|____/|____/|____/

                    Hobbyist Bulletin Board System
================================================================================

    ようこそ HOBBS へ！

    接続日時: 2025/01/15 20:30:45

    このBBSは、レトロなパソコン通信の雰囲気を
    現代に蘇らせた趣味のコミュニティです。

================================================================================
    [L] ログイン    [N] 新規登録    [G] ゲスト    [Q] 切断
--------------------------------------------------------------------------------
選択 >
```

### 2.2 ログイン画面

```
================================================================================
                           ログイン
================================================================================

    ユーザーID: _

    パスワード: ********

--------------------------------------------------------------------------------
    [Enter] ログイン    [Q] 戻る
--------------------------------------------------------------------------------
>
```

### 2.3 新規登録画面

```
================================================================================
                         新規会員登録
================================================================================

    ユーザーID (4-16文字、英数字): _

    パスワード (8文字以上): ********

    パスワード確認: ********

    ニックネーム: _

    メールアドレス (任意): _

--------------------------------------------------------------------------------
    [Enter] 登録    [Q] キャンセル
--------------------------------------------------------------------------------
>
```

### 2.4 メインメニュー

```
================================================================================
    HOBBS メインメニュー                          ユーザー: たろう [会員]
================================================================================

    [B] 掲示板            - みんなの掲示板を見る
    [C] チャット          - リアルタイムで会話する (現在 3人)
    [M] メール            - 会員間メッセージ (未読: 2通)
    [F] ファイル          - ファイルライブラリ
    [P] プロフィール      - 自分の情報を見る・変更する
    [W] 会員一覧          - 会員リストを見る

    [A] 管理メニュー      - ※管理者専用

    [Q] ログアウト

--------------------------------------------------------------------------------
    最終ログイン: 2025/01/14 18:20:00
--------------------------------------------------------------------------------
選択 >
```

### 2.5 掲示板一覧

```
================================================================================
    掲示板一覧                                              未読合計: 17件
================================================================================

    No.  掲示板名                  記事数  未読    最新投稿
    ───────────────────────────────────────────────────────────────────────
     1   お知らせ                      15    2*   2025/01/15 10:00
     2   雑談                         234   15*   2025/01/15 20:15
     3   質問                          89    0    2025/01/15 19:45
     4   趣味・ホビー                 156    0    2025/01/15 18:30
     5   プログラミング                67    0    2025/01/14 22:10

--------------------------------------------------------------------------------
    [番号] 掲示板を開く    [U] 未読一気読み    [A] 全て既読    [Q] 戻る
--------------------------------------------------------------------------------
選択 >
```

### 2.6 スレッド一覧（スレッド形式）

```
================================================================================
    掲示板: 雑談                                    未読: 15件 [スレッド形式]
================================================================================

    No.  タイトル                        投稿者    レス  未読  最新
    ───────────────────────────────────────────────────────────────────────
     1   最近買ったもの自慢スレ          はなこ      45    3*  01/15 20:15
     2   今日の晩ごはん                  たろう      23   12*  01/15 19:50
     3   週末の予定を語るスレ            じろう      12    0   01/15 18:30
     4   お気に入りの音楽                さぶろう     8    0   01/15 15:00
     5   レトロPC談義                    しろう      67    0   01/14 23:45

    ページ: 1/5    [N] 次ページ    [P] 前ページ
--------------------------------------------------------------------------------
    [番号] 開く  [U] 未読一気読み  [A] 既読に  [W] 新規  [Q] 戻る
--------------------------------------------------------------------------------
選択 >
```

### 2.7 記事一覧（フラット形式）

```
================================================================================
    掲示板: お知らせ                                未読: 2件 [フラット形式]
================================================================================

    No.  *   タイトル                          投稿者    日時
    ───────────────────────────────────────────────────────────────────────
    15   *   【重要】メンテナンスのお知らせ    SysOp     01/15 10:00
    14   *   新機能追加しました                SysOp     01/10 15:30
    13       年末年始の運用について            SysOp     12/28 12:00
    12       掲示板を追加しました              SysOp     12/15 20:00
    11       会員登録ありがとうございます      SysOp     12/01 10:00

    * = 未読    ページ: 1/3    [N] 次ページ    [P] 前ページ
--------------------------------------------------------------------------------
    [番号] 読む  [U] 未読一気読み  [A] 既読に  [W] 新規  [Q] 戻る
--------------------------------------------------------------------------------
選択 >
```

### 2.8 未読一気読み画面

```
================================================================================
    未読一気読み                                               残り: 14件
================================================================================
    掲示板: 雑談
    スレッド: 最近買ったもの自慢スレ
    投稿者: はなこ                              日時: 2025/01/15 20:15:30
--------------------------------------------------------------------------------

    先週、念願のメカニカルキーボードを買いました！

    Cherry MX の青軸で、打鍵感が最高です。
    カチカチ音がうるさいかと思ったけど、
    むしろクセになりますね。

    みなさんの最近の買い物も教えてください！

--------------------------------------------------------------------------------
    [Enter] 次の未読    [S] この板スキップ    [Q] 終了
--------------------------------------------------------------------------------
>
```

### 2.9 記事詳細表示

```
================================================================================
    掲示板: 雑談 > 最近買ったもの自慢スレ                      レス 45/45
================================================================================
    投稿者: はなこ                              日時: 2025/01/15 20:15:30
--------------------------------------------------------------------------------

    先週、念願のメカニカルキーボードを買いました！

    Cherry MX の青軸で、打鍵感が最高です。
    カチカチ音がうるさいかと思ったけど、
    むしろクセになりますね。

    みなさんの最近の買い物も教えてください！

--------------------------------------------------------------------------------
    [R] 返信    [N] 次の記事    [P] 前の記事    [Q] 一覧に戻る
--------------------------------------------------------------------------------
>
```

### 2.10 記事投稿画面

```
================================================================================
    新規投稿
================================================================================
    掲示板: 雑談
    スレッド: 最近買ったもの自慢スレ
--------------------------------------------------------------------------------

    本文を入力してください（終了は「.」のみの行）:

    > 私も最近キーボード買いました！
    > 静電容量無接点方式のやつです。
    > 青軸とは違う、スコスコした打鍵感がいいですよ。
    > .

--------------------------------------------------------------------------------
    投稿しますか？ [Y] はい    [N] いいえ
--------------------------------------------------------------------------------
>
```

### 2.11 チャットルーム

```
================================================================================
    チャットルーム                                             参加者: 4人
================================================================================

    [20:30:15] === たろう が入室しました ===
    [20:30:20] はなこ: こんばんは〜
    [20:30:25] たろう: こんばんは！
    [20:30:30] じろう: やあ
    [20:31:00] はなこ: 今日は寒いですね
    [20:31:15] じろう: うん、こっちは雪降ってるよ
    [20:31:30] たろう: こっちは晴れてるけど風が冷たい
    [20:32:00] さぶろう: ただいま〜

    現在の参加者: たろう, はなこ, じろう, さぶろう
--------------------------------------------------------------------------------
    [/quit] 退室    [/who] 参加者一覧    [/help] ヘルプ
--------------------------------------------------------------------------------
発言 >
```

### 2.12 メール一覧

```
================================================================================
    メールボックス                                            未読: 2通
================================================================================

    No.  状態  差出人          件名                    日時
    ───────────────────────────────────────────────────────────────────────
     1   ●    はなこ          Re: 週末の件            01/15 19:00
     2   ●    SysOp           ようこそHOBBSへ         01/15 12:00
     3        じろう          お元気ですか？          01/14 20:30
     4        はなこ          週末の件                01/13 18:00
     5        さぶろう        先日はありがとう        01/10 15:00

    ● = 未読    ページ: 1/1
--------------------------------------------------------------------------------
    [番号] メールを読む    [W] 新規メール    [Q] 戻る
--------------------------------------------------------------------------------
選択 >
```

### 2.13 メール詳細

```
================================================================================
    メール詳細
================================================================================
    差出人: はなこ                              日時: 2025/01/15 19:00:00
    宛先:   たろう
    件名:   Re: 週末の件
--------------------------------------------------------------------------------

    たろうさん

    週末の集まり、了解しました！
    15時に駅前で待ち合わせですね。

    楽しみにしています。

    はなこ

--------------------------------------------------------------------------------
    [R] 返信    [D] 削除    [N] 次    [P] 前    [Q] 一覧に戻る
--------------------------------------------------------------------------------
>
```

### 2.14 ファイル一覧

```
================================================================================
    ファイルライブラリ > 共有ファイル
================================================================================

    No.  ファイル名                サイズ      DL数    日時
    ───────────────────────────────────────────────────────────────────────
     1   readme.txt                  2.1KB       45    01/15 10:00
     2   sample_code.zip            15.3KB       23    01/14 18:00
     3   photo_2025.jpg            256.0KB       12    01/13 12:00

    フォルダ:
     [A] フリーソフト
     [B] ドキュメント

    ページ: 1/1
--------------------------------------------------------------------------------
    [番号] ダウンロード    [U] アップロード    [Q] 戻る
--------------------------------------------------------------------------------
選択 >
```

### 2.15 プロフィール

```
================================================================================
    プロフィール
================================================================================

    ユーザーID:   たろう
    ニックネーム: たろう
    権限:         一般会員
    メール:       taro@example.com

    登録日:       2024/12/01
    最終ログイン: 2025/01/14 18:20:00
    投稿数:       123件

    ─ 自己紹介 ─────────────────────────────────────────────────────────────
    こんにちは、たろうです。
    レトロPCとプログラミングが趣味です。
    よろしくお願いします！
    ────────────────────────────────────────────────────────────────────────

--------------------------------------------------------------------------------
    [E] 編集    [P] パスワード変更    [Q] 戻る
--------------------------------------------------------------------------------
選択 >
```

### 2.16 管理メニュー（SysOp/SubOp用）

```
================================================================================
    管理メニュー                                              権限: SysOp
================================================================================

    === 掲示板管理 ===
    [1] 掲示板一覧・編集
    [2] 掲示板追加
    [3] 投稿削除

    === ファイル管理 ===
    [4] フォルダ一覧・編集
    [5] フォルダ追加
    [6] ファイル削除

    === ユーザー管理 ===
    [7] ユーザー一覧
    [8] ユーザー編集
    [9] 権限変更

    === システム ===
    [0] 接続中ユーザー一覧

    [Q] メインメニューに戻る
--------------------------------------------------------------------------------
選択 >
```

## 3. 画面レイアウト - C64モード（40x25、プレーンテキスト）

C64および40カラム端末向けのプレーンテキストレイアウト。
全ての文字が等幅（全角も1カラム）として扱われる。

### 3.1 ウェルカム画面

```
========================================
    _  _  ___  ___  ___  ___
   | || |/ _ \| _ )| _ )/ __|
   | __ | (_) | _ \| _ \\__ \
   |_||_|\___/|___/|___/|___/

  Hobbyist Bulletin Board System
========================================

  ようこそ HOBBS へ！

  接続: 2025/01/15 20:30

  レトロなパソコン通信BBSです。
  ごゆっくりどうぞ。

========================================
[L]ログイン [N]新規 [G]ゲスト [Q]切断
----------------------------------------
選択 >
```

### 3.2 ログイン画面

```
========================================
          ログイン
========================================

  ユーザーID: _

  パスワード: ********

----------------------------------------
  [Enter] ログイン  [Q] 戻る
----------------------------------------
>
```

### 3.3 メインメニュー

```
========================================
     HOBBS メインメニュー
        ユーザー: たろう
========================================

 [B] 掲示板
 [C] チャット        (3人)
 [M] メール        (未読2)
 [F] ファイル
 [P] プロフィール
 [W] 会員一覧

 [A] 管理 *SysOp専用

 [Q] ログアウト

----------------------------------------
最終: 2025/01/14 18:20
----------------------------------------
選択 >
```

### 3.4 掲示板一覧

```
========================================
  掲示板一覧        未読合計:17
========================================

No. 掲示板名        記事 未読
----------------------------------------
 1  お知らせ          15   2*
 2  雑談             234  15*
 3  質問              89   0
 4  趣味・ホビー     156   0
 5  プログラミング    67   0

----------------------------------------
[番号]開く [U]未読 [A]既読 [Q]戻る
----------------------------------------
選択 >
```

### 3.5 スレッド一覧

```
========================================
  掲示板: 雑談   未読:15 [スレッド]
========================================

No. タイトル        投稿者 Res 未読
----------------------------------------
 1  最近買ったもの  はなこ  45   3*
 2  今日の晩ごはん  たろう  23  12*
 3  週末の予定      じろう  12   0
 4  お気に入り音楽さぶろう   8   0
 5  レトロPC談義    しろう  67   0

ページ: 1/5  [N]次 [P]前
----------------------------------------
[番号]開く [U]未読 [A]既読 [W]新規
[Q]戻る
----------------------------------------
選択 >
```

### 3.6 記事詳細

```
========================================
雑談 > 最近買ったもの自慢スレ
              レス 45/45
========================================
投稿者: はなこ
日時: 2025/01/15 20:15
----------------------------------------

先週、念願のメカニカル
キーボードを買いました！

Cherry MX の青軸で、
打鍵感が最高です。

みなさんの最近の買い物も
教えてください！

----------------------------------------
[R]返信 [N]次 [P]前 [Q]戻る
----------------------------------------
>
```

### 3.7 未読一気読み画面

```
========================================
  未読一気読み         残り:14
========================================
掲示板: 雑談
スレッド: 最近買ったもの自慢スレ
投稿者: はなこ
日時: 2025/01/15 20:15
----------------------------------------

先週、念願のメカニカル
キーボードを買いました！

Cherry MX の青軸で、
打鍵感が最高です。

みなさんの最近の買い物も
教えてください！

----------------------------------------
[Enter]次 [S]板スキップ [Q]終了
----------------------------------------
>
```

### 3.8 チャットルーム

```
========================================
  チャットルーム         4人
========================================

[20:30] たろう入室
[20:30] はなこ: こんばんは
[20:30] たろう: こんばんは！
[20:31] じろう: やあ
[20:31] はなこ: 今日は寒いね
[20:31] じろう: こっち雪だよ
[20:32] さぶろう: ただいま

参加: たろう,はなこ,じろう,
      さぶろう
----------------------------------------
/quit:退室 /who:一覧 /help
----------------------------------------
発言 >
```

### 3.9 メール一覧

```
========================================
   メールボックス     未読:2
========================================

No. *  差出人    件名
----------------------------------------
 1  *  はなこ    Re: 週末の件
 2  *  SysOp     ようこそ
 3     じろう    お元気ですか
 4     はなこ    週末の件
 5     さぶろう  ありがとう

* = 未読  ページ: 1/1
----------------------------------------
[番号]読む [W]新規 [Q]戻る
----------------------------------------
選択 >
```

### 3.10 メール詳細

```
========================================
       メール詳細
========================================
差出人: はなこ
宛先:   たろう
件名:   Re: 週末の件
日時:   2025/01/15 19:00
----------------------------------------

たろうさん

週末の集まり、了解しました！
15時に駅前で待ち合わせですね。

楽しみにしています。

はなこ

----------------------------------------
[R]返信 [D]削除 [N]次 [P]前 [Q]戻る
----------------------------------------
>
```

### 3.11 ファイル一覧

```
========================================
ファイル > 共有ファイル
========================================

No. ファイル名      サイズ DL
----------------------------------------
 1  readme.txt       2.1K  45
 2  sample.zip      15.3K  23
 3  photo.jpg      256.0K  12

フォルダ:
 [A] フリーソフト
 [B] ドキュメント

----------------------------------------
[番号]DL [U]UP [Q]戻る
----------------------------------------
選択 >
```

### 3.12 プロフィール

```
========================================
      プロフィール
========================================

ユーザーID:   たろう
ニックネーム: たろう
権限:         一般会員
メール:       taro@example.com

登録日:       2024/12/01
最終ログイン: 2025/01/14
投稿数:       123件

-- 自己紹介 --
こんにちは、たろうです。
レトロPCとプログラミングが
趣味です。よろしく！
--------------

----------------------------------------
[E]編集 [P]パスワード [Q]戻る
----------------------------------------
選択 >
```

### 3.13 管理メニュー

```
========================================
  管理メニュー      権限:SysOp
========================================

=== 掲示板管理 ===
 [1] 掲示板一覧・編集
 [2] 掲示板追加
 [3] 投稿削除

=== ファイル管理 ===
 [4] フォルダ一覧
 [5] フォルダ追加
 [6] ファイル削除

=== ユーザー管理 ===
 [7] ユーザー一覧
 [8] ユーザー編集
 [9] 権限変更

=== システム ===
 [0] 接続中ユーザー

[Q] メインメニューに戻る
----------------------------------------
選択 >
```

### 3.14 端末タイプ選択画面

```
========================================
    端末タイプ選択
========================================

接続ありがとうございます。
お使いの端末を選択してください。

 [1] Standard (80x24, ShiftJIS)
     TeraTerm, PuTTY等（日本語）

 [2] Standard UTF-8 (80x24)
     TeraTerm, PuTTY等（UTF-8）

 [3] DOS/IBM PC (80x25, CP437)
     DOS端末、IBM PC互換機

 [4] C64 Plain (40x25)
     ANSI非対応C64

 [5] C64 PETSCII (40x25)
     PETSCII制御コード使用

 [6] C64 ANSI (40x25)
     ANSI対応エミュレータ

----------------------------------------
選択 >
```

カスタムプロファイルが `config.toml` で定義されている場合、追加で表示されます。

## 4. 色使いの指針（ANSI対応端末向け）

| 要素 | 色 | ANSIコード |
|------|-----|------------|
| タイトル・見出し | シアン | 36 |
| メニュー記号 | 黄色 | 33 |
| エラーメッセージ | 赤 | 31 |
| 成功メッセージ | 緑 | 32 |
| 警告メッセージ | 黄色 | 33 |
| 情報メッセージ | シアン | 36 |
| ユーザー名 | マゼンタ | 35 |
| 日時 | 青 | 34 |
| 強調 | 太字白 | 1;37 |
| 罫線 | 暗い白 | 37 |

## 5. 共通UI要素

### 5.1 ヘッダー（80カラム版）
```
================================================================================
    タイトル                                              右寄せ情報
================================================================================
```

### 5.2 フッター（80カラム版）
```
--------------------------------------------------------------------------------
    [コマンド] 説明    [コマンド] 説明    [Q] 戻る
--------------------------------------------------------------------------------
>
```

### 5.3 ヘッダー/フッター（40カラム版）

```
========================================
    タイトル
========================================
```

```
----------------------------------------
[コマンド]説明 [Q]戻る
----------------------------------------
>
```

### 5.4 ページング
```
    ページ: 1/5    [N] 次ページ    [P] 前ページ
```

### 5.5 確認ダイアログ
```
    本当に削除しますか？ [Y] はい    [N] いいえ
```

### 5.6 エラー表示

**ANSI対応時：**
```
    [エラー] ユーザー名またはパスワードが間違っています
```

**プレーンテキスト時：**
```
*エラー* ユーザー名またはパスワードが間違っています
```

### 5.7 成功表示

**ANSI対応時：**
```
    [成功] 投稿が完了しました
```

**プレーンテキスト時：**
```
[OK] 投稿が完了しました
```

## 6. テンプレート変数

画面テンプレートで使用できる変数一覧。詳細は `docs/03_features/07_customization.md` を参照。

### 6.1 システム変数

| 変数 | 説明 | 例 |
|------|------|-----|
| `{{bbs.name}}` | BBS名 | HOBBS - Hobbyist BBS |
| `{{bbs.sysop}}` | SysOp名 | SysOp |
| `{{bbs.description}}` | BBS説明 | レトロなパソコン通信BBS |
| `{{system.date}}` | 現在日付 | 2025/01/15 |
| `{{system.time}}` | 現在時刻 | 20:30:45 |
| `{{system.datetime}}` | 日時 | 2025/01/15 20:30:45 |
| `{{system.online}}` | 接続中ユーザー数 | 3 |

### 6.2 ユーザー変数（ログイン後）

| 変数 | 説明 | 例 |
|------|------|-----|
| `{{user.name}}` | ユーザー名 | たろう |
| `{{user.nickname}}` | ニックネーム | たろう |
| `{{user.role}}` | 権限 | 会員 / SubOp / SysOp |
| `{{user.last_login}}` | 最終ログイン | 2025/01/14 18:20 |
| `{{user.unread_mail}}` | 未読メール数 | 2 |
| `{{user.unread_posts}}` | 未読投稿数 | 17 |
| `{{user.is_sysop}}` | SysOpか | true / false |
| `{{user.is_subop}}` | SubOp以上か | true / false |

### 6.3 翻訳参照

| 構文 | 説明 |
|------|------|
| `{{t "menu.login"}}` | 言語リソースから翻訳を取得 |

### 6.4 条件分岐

```
{{#if user.is_sysop}}
  [A] 管理メニュー
{{/if}}
```
